<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title th:text="${post.title} + ' - ì»¤ë®¤ë‹ˆí‹°'">ê²Œì‹œê¸€ - ì»¤ë®¤ë‹ˆí‹°</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
        'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
      background-color: #f9fafb;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* ë©”ì¸ ë ˆì´ì•„ì›ƒ - 3ë‹¨ êµ¬ì¡° */
    .main-layout {
      flex: 1;
      max-width: 1400px;
      width: 100%;
      margin: 0 auto;
      padding: 2rem 1rem;
      display: grid;
      grid-template-columns: 280px 1fr 320px;
      gap: 2rem;
    }

    /* ì¢Œì¸¡ ì‚¬ì´ë“œë°” */
    .sidebar-left {
      position: sticky;
      top: 2rem;
      height: fit-content;
    }

    .author-card {
      background: white;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .author-avatar-large {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      margin: 0 auto 1rem;
      display: block;
      border: 3px solid #e5e7eb;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      font-weight: 700;
    }

    .author-name-large {
      text-align: center;
      font-size: 1.1rem;
      font-weight: 600;
      color: #1f2937;
      margin-bottom: 0.5rem;
    }

    .author-bio {
      text-align: center;
      font-size: 0.85rem;
      color: #6b7280;
      margin-bottom: 1rem;
      line-height: 1.4;
    }

    .author-stats {
      display: flex;
      justify-content: space-around;
      padding: 1rem 0;
      border-top: 1px solid #f3f4f6;
      border-bottom: 1px solid #f3f4f6;
      margin-bottom: 1rem;
    }
	.btn-follow.following {
    background: #6b7280;
	}
	
	.btn-follow.following:hover {
	    background: #dc2626;
	}
	
	.btn-follow.following:hover span::after {
	    content: ' ì·¨ì†Œ';
	}
    .stat-box { text-align: center; }

    .stat-value {
      display: block;
      font-size: 1.25rem;
      font-weight: 700;
      color: #2563eb;
    }

    .stat-label {
      display: block;
      font-size: 0.75rem;
      color: #6b7280;
      margin-top: 0.25rem;
    }

    .btn-follow {
      width: 100%;
      padding: 0.75rem;
      background: #2563eb;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }

    .btn-follow:hover { background: #1d4ed8; }

    .sidebar-section {
      background: white;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .sidebar-title {
      font-size: 1rem;
      font-weight: 600;
      color: #1f2937;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .related-list { list-style: none; }

    .related-list li {
      margin-bottom: 0.75rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid #f3f4f6;
    }

    .related-list li:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }

    .related-list a {
      color: #374151;
      text-decoration: none;
      font-size: 0.9rem;
      line-height: 1.4;
      display: block;
      transition: color 0.2s;
    }

    .related-list a:hover { color: #2563eb; }

    /* ë©”ì¸ ì»¨í…ì¸  */
    main { min-width: 0; }

    .back-button {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      color: #6b7280;
      text-decoration: none;
      font-size: 0.9rem;
      margin-bottom: 1.5rem;
      padding: 0.5rem 0;
      transition: color 0.2s;
    }

    .back-button:hover { color: #2563eb; }

    .back-button svg { width: 16px; height: 16px; }

    .post-container {
      background-color: white;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      overflow: hidden;
      margin-bottom: 1.5rem;
    }

    .post-header {
      padding: 2rem;
      border-bottom: 1px solid #e5e7eb;
    }

    .post-category {
      display: inline-block;
      padding: 0.375rem 0.75rem;
      background-color: #dbeafe;
      color: #2563eb;
      font-size: 0.8rem;
      font-weight: 600;
      border-radius: 6px;
      margin-bottom: 1rem;
    }

    .post-title {
      font-size: 1.75rem;
      font-weight: 700;
      color: #1f2937;
      margin-bottom: 1rem;
      line-height: 1.4;
    }

    .post-meta {
      display: flex;
      align-items: center;
      gap: 1rem;
      color: #6b7280;
      font-size: 0.9rem;
      flex-wrap: wrap;
    }

    .author-info {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .author-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.9rem;
      border: 2px solid #e5e7eb;
    }

    .author-name { font-weight: 500; color: #1f2937; }

    .post-stats {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-left: auto;
    }

    .stat-item {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }

    .stat-item svg { width: 16px; height: 16px; }

    /* ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ */
    .post-edit-actions {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid #f3f4f6;
    }

    .btn-edit, .btn-delete {
      padding: 0.5rem 1rem;
      border: 1px solid #e5e7eb;
      background: white;
      border-radius: 6px;
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-edit:hover {
      background: #f9fafb;
      border-color: #2563eb;
      color: #2563eb;
    }

    .btn-delete { color: #dc2626; }

    .btn-delete:hover {
      background: #fef2f2;
      border-color: #dc2626;
    }

    /* ì´ë¯¸ì§€ ëª¨ë‹¬ */
    .image-modal {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      z-index: 9999;
      padding: 2rem;
      cursor: pointer;
    }

    .image-modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .image-modal img {
      max-width: 90%;
      max-height: 90vh;
      object-fit: contain;
    }

    .post-content {
      padding: 2rem;
      color: #374151;
      font-size: 1rem;
      line-height: 1.8;
      word-break: break-word;
    }

    .post-content p { margin-bottom: 1rem; }

    /* blocks ì´ë¯¸ì§€ ê³µí†µ */
    .post-image {
      width: auto;
      max-width: 80%;
      height: auto;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.3s;
      display: inline-block;
    }

    .post-image:hover { transform: scale(1.02); }

    .post-actions {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 1.5rem 2rem;
      border-top: 1px solid #e5e7eb;
    }

    .action-button {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.625rem 1rem;
      border: 1px solid #e5e7eb;
      background-color: white;
      border-radius: 8px;
      font-size: 0.9rem;
      color: #6b7280;
      cursor: pointer;
      transition: all 0.2s;
    }

    .action-button:hover {
      background-color: #f9fafb;
      border-color: #d1d5db;
    }

    .action-button.liked {
      color: #ef4444;
      border-color: #fecaca;
      background-color: #fef2f2;
    }

    .action-button.bookmarked {
      color: #f59e0b;
      border-color: #fed7aa;
      background-color: #fffbeb;
    }

    .action-button svg { width: 18px; height: 18px; }

    .share-button { margin-left: auto; }

    /* ì´ì „ê¸€/ë‹¤ìŒê¸€ ë„¤ë¹„ê²Œì´ì…˜ */
    .post-navigation {
      background: white;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      overflow: hidden;
      margin-bottom: 1.5rem;
    }

    .nav-item {
      padding: 1.25rem 1.5rem;
      border-bottom: 1px solid #f3f4f6;
      transition: background 0.2s;
    }

    .nav-item:last-child { border-bottom: none; }

    .nav-item:hover { background: #f9fafb; }

    .nav-label {
      display: block;
      font-size: 0.75rem;
      color: #9ca3af;
      margin-bottom: 0.5rem;
      font-weight: 600;
    }

    .nav-link {
      color: #374151;
      text-decoration: none;
      font-size: 0.95rem;
      line-height: 1.4;
      display: block;
    }

    .nav-link:hover { color: #2563eb; }

    .nav-empty {
      color: #9ca3af;
      font-style: italic;
    }

    /* ëŒ“ê¸€ ì„¹ì…˜ */
    .comments-section {
      background-color: white;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      overflow: hidden;
    }

    .comments-header {
      padding: 1.5rem 2rem;
      border-bottom: 1px solid #e5e7eb;
    }

    .comments-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: #1f2937;
    }

    .comments-count { color: #2563eb; }

    .comment-form {
      padding: 2rem;
      border-bottom: 1px solid #e5e7eb;
    }

    .comment-notice {
      text-align: center;
      padding: 2rem;
      color: #6b7280;
      border-bottom: 1px solid #e5e7eb;
    }

    .comment-notice a {
      color: #2563eb;
      text-decoration: none;
      font-weight: 500;
    }

    .comment-notice a:hover { text-decoration: underline; }

    .comment-textarea {
      width: 100%;
      min-height: 100px;
      padding: 1rem;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      font-size: 0.95rem;
      font-family: inherit;
      resize: vertical;
      transition: border-color 0.2s;
    }

    .comment-textarea:focus {
      outline: none;
      border-color: #2563eb;
    }

    .comment-form-actions {
      display: flex;
      justify-content: flex-end;
      margin-top: 1rem;
    }

    .submit-comment-btn {
      padding: 0.75rem 1.5rem;
      background-color: #2563eb;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .submit-comment-btn:hover { background-color: #1d4ed8; }

    .comment-item {
      padding: 1.5rem 2rem;
      border-bottom: 1px solid #f3f4f6;
    }

    .comment-item:last-child { border-bottom: none; }

    .comment-author {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 0.75rem;
    }

    .comment-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.9rem;
      border: 2px solid #e5e7eb;
    }

    .comment-author-info { flex: 1; }

    .comment-author-name {
      font-weight: 500;
      color: #1f2937;
      font-size: 0.95rem;
    }

    .comment-date {
      color: #9ca3af;
      font-size: 0.85rem;
    }

    .comment-content {
      color: #374151;
      line-height: 1.6;
      margin-left: 3rem;
      margin-bottom: 0.75rem;
    }

    .comment-actions-row {
      margin-left: 3rem;
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    .comment-action-btn {
      background: none;
      border: none;
      color: #9ca3af;
      font-size: 0.85rem;
      cursor: pointer;
      padding: 0.25rem 0.5rem;
      transition: color 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.25rem;
    }

    .comment-action-btn span { margin-top: 2px; }

    .comment-action-btn:hover { color: #2563eb; }

    .comment-action-btn.liked { color: #ef4444; }

    .empty-comments {
      padding: 3rem 2rem;
      text-align: center;
      color: #9ca3af;
    }

    /* ìš°ì¸¡ ì‚¬ì´ë“œë°” */
    .sidebar-right {
      position: sticky;
      top: 2rem;
      height: fit-content;
    }

    .popular-list { list-style: none; }

    .popular-item {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid #f3f4f6;
    }

    .popular-item:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }

    .popular-rank {
      flex-shrink: 0;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: #f3f4f6;
      color: #6b7280;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 0.85rem;
    }

    .popular-rank.top3 {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
    }

    .popular-content { flex: 1; min-width: 0; }

    .popular-title {
      display: block;
      color: #374151;
      text-decoration: none;
      font-size: 0.9rem;
      line-height: 1.4;
      margin-bottom: 0.25rem;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .popular-title:hover { color: #2563eb; }

    .popular-stats {
      display: flex;
      gap: 0.75rem;
      font-size: 0.75rem;
      color: #9ca3af;
    }

    .tags-cloud {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .tag-item {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.5rem 0.75rem;
      background: #f3f4f6;
      border-radius: 16px;
      color: #374151;
      text-decoration: none;
      font-size: 0.85rem;
      transition: all 0.2s;
    }

    .tag-item:hover {
      background: #dbeafe;
      color: #2563eb;
    }

    .ad-banner {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 2rem;
      border-radius: 8px;
      color: white;
      text-align: center;
    }

    .ad-label {
      font-size: 0.7rem;
      opacity: 0.8;
      margin-bottom: 1rem;
    }

    .ad-banner h5 {
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
    }

    .ad-banner p {
      font-size: 0.9rem;
      opacity: 0.9;
      margin-bottom: 1rem;
    }
/* âœ… ë¸”ë¡ ë‹¨ìœ„ ê°œí–‰(AAA/ì´ë¯¸ì§€/CCC/DDD/ì´ë¯¸ì§€) ë³´ì¥ */
.pd-block{
  margin: 1.1rem 0;
}

/* âœ… í…ìŠ¤íŠ¸ ë‚´ë¶€ ì—”í„°(CCC\nDDD) ë³´ì¡´ */
.pd-text{
  white-space: pre-wrap;
}

    .ad-btn {
      padding: 0.625rem 1.25rem;
      background: white;
      color: #667eea;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .ad-btn:hover { transform: translateY(-2px); }

    /* ë°˜ì‘í˜• */
    @media (max-width: 1200px) {
      .main-layout { grid-template-columns: 1fr 320px; }
      .sidebar-left { display: none; }
    }

    @media (max-width: 768px) {
      .main-layout { grid-template-columns: 1fr; padding: 1rem 0.5rem; }
      .sidebar-right { display: none; }
      .post-header { padding: 1.5rem 1rem; }
      .post-title { font-size: 1.5rem; }
      .post-content { padding: 1.5rem 1rem; }
      .post-actions { padding: 1rem; flex-wrap: wrap; }
      .comment-content, .comment-actions-row { margin-left: 0; margin-top: 0.5rem; }
      .post-image { max-width: 100%; }
    }
  </style>
</head>

<body>
  <th:block th:include="common/header"></th:block>

  <div class="main-layout">
    <!-- ì¢Œì¸¡ ì‚¬ì´ë“œë°” -->
    <aside class="sidebar-left">
      <!-- ì‘ì„±ì ì¹´ë“œ -->
	<div class="author-card">
	    <div class="author-avatar-large">
	        <img th:if="${post.authorProfileImage != null and !post.authorProfileImage.isEmpty()}"
	             th:src="@{/uploads/{name}(name=${post.authorProfileImage})}"
	             alt="author"
	             style="width:100%; height:100%; border-radius:50%; object-fit:cover; display:block;" />
	        <span th:unless="${post.authorProfileImage != null and !post.authorProfileImage.isEmpty()}"
	              th:text="${post.authorName != null ? post.authorName.substring(0, 1) : 'U'}">ê¹€</span>
	    </div>
	    <h3 class="author-name-large" th:text="${post.authorName}">ì‘ì„±ì</h3>
	
	    <!-- BIO -->
	    <p class="author-bio"
	       th:text="${post.authorBio != null and !post.authorBio.isEmpty() ? post.authorBio : 'ìê¸°ì†Œê°œê°€ ì—†ìŠµë‹ˆë‹¤.'}">
	    </p>
	
	    <div class="author-stats">
	        <div class="stat-box">
	            <span class="stat-value" th:text="${authorStats.postCount}">0</span>
	            <span class="stat-label">ê²Œì‹œê¸€</span>
	        </div>
	        <div class="stat-box">
	            <span class="stat-value" th:text="${authorStats.commentCount}">0</span>
	            <span class="stat-label">ëŒ“ê¸€</span>
	        </div>
	        <!-- âœ… íŒ”ë¡œì›Œ ìˆ˜ ì¶”ê°€ -->
	        <div class="stat-box">
	            <span class="stat-value" id="followerCount" th:text="${post.authorFollowerCount}">0</span>
	            <span class="stat-label">íŒ”ë¡œì›Œ</span>
	        </div>
	    </div>
    
    <!-- âœ… íŒ”ë¡œìš° ë²„íŠ¼ (ìê¸° ìì‹ ì´ë©´ ìˆ¨ê¹€) -->
    <button th:if="${memberId != post.authorId}" 
            class="btn-follow" 
            id="followButton"
            th:classappend="${post.isFollowing} ? 'following' : ''"
            onclick="followAuthor()">
        <span th:text="${post.isFollowing} ? 'íŒ”ë¡œì‰' : 'íŒ”ë¡œìš°'">íŒ”ë¡œìš°</span>
    </button>
</div>
      <!-- ì‘ì„±ìì˜ ë‹¤ë¥¸ ê¸€ -->
      <div class="sidebar-section">
        <h4 class="sidebar-title">âœï¸ ì‘ì„±ìì˜ ë‹¤ë¥¸ ê¸€</h4>
        <ul class="related-list">
          <li th:if="${authorOtherPosts == null or authorOtherPosts.isEmpty()}">
            <span style="color:#9ca3af; font-size:0.85rem;">ë‹¤ë¥¸ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</span>
          </li>
          <li th:each="otherPost : ${authorOtherPosts}">
            <a th:href="@{/board/postDetail/{id}(id=${otherPost.postId})}"
               th:text="${otherPost.title}">ê²Œì‹œê¸€ ì œëª©</a>
          </li>
        </ul>
      </div>
    </aside>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <main>
      <a href="/board" class="back-button">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 12H5M12 19l-7-7 7-7" />
        </svg>
        ëª©ë¡ìœ¼ë¡œ
      </a>

      <!-- ê²Œì‹œê¸€ ì»¨í…Œì´ë„ˆ -->
      <div class="post-container">
        <div class="post-header">
          <span class="post-category" th:text="${post.category}"></span>
          <h1 class="post-title" th:text="${post.title}"></h1>

          <div class="post-meta">
            <div class="author-info">
              <div class="author-avatar">
				  <img th:if="${post.authorProfileImage != null and !post.authorProfileImage.isEmpty()}"
				       th:src="@{/uploads/{name}(name=${post.authorProfileImage})}"
				       alt="author"
				       style="width:100%; height:100%; border-radius:50%; object-fit:cover; display:block;" />
				  <span th:unless="${post.authorProfileImage != null and !post.authorProfileImage.isEmpty()}"
				        th:text="${post.authorName != null ? post.authorName.substring(0, 1) : 'U'}">U</span>
			</div>
              <span class="author-name" th:text="${post.authorName}"></span>
            </div>

            <span class="post-date">
              <span th:text="${dateUtil != null ? dateUtil.formatDate(post.createdAt) : '0000.00.00'}"></span>
              <span th:text="${dateUtil != null ? dateUtil.formatTime(post.createdAt) : '00:00'}"></span>
            </span>

            <div class="post-stats">
              <span class="stat-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                  <circle cx="12" cy="12" r="3"></circle>
                </svg>
                <span th:text="${post.viewCount}"></span>
              </span>

              <span class="stat-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
                <span th:text="${post.commentCount}"></span>
              </span>
            </div>
          </div>

          <!-- ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ (ì‘ì„±ìë§Œ ë³´ì„) -->
          <div class="post-edit-actions" th:if="${isAuthenticated and memberId == post.authorId}">
            <button class="btn-edit" onclick="editPost()">
              <svg style="width:14px; height:14px; display:inline; vertical-align:middle;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
              </svg>
              ìˆ˜ì •
            </button>
            <button class="btn-delete" onclick="deletePost()">
              <svg style="width:14px; height:14px; display:inline; vertical-align:middle;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
              </svg>
              ì‚­ì œ
            </button>
          </div>
        </div>

        <!-- âœ… ë³¸ë¬¸ (blocksMeta ê¸°ë°˜ blocks ìš°ì„ , ì—†ìœ¼ë©´ content fallback) -->
<div class="post-content">
  <!-- âœ… controllerì—ì„œ ë‚´ë ¤ì¤€ blocks ì‚¬ìš© -->
  <th:block th:if="${blocks != null and !blocks.isEmpty()}">
    <th:block th:each="block : ${blocks}">

      <!-- âœ… TEXT BLOCK : ì—”í„°(ê°œí–‰) ìœ ì§€ -> white-space:pre-wrap ë¡œ ì²˜ë¦¬ -->
      <div class="pd-block" th:if="${block.type == 'text'}">
        <div class="pd-text" th:text="${block.text}"></div>
      </div>

      <div class="pd-block pd-img-wrap" th:if="${block.type == 'image'}">
  <img class="post-image"
       th:src="@{/uploads/{name}(name=${block.saveName})}"
       th:alt="${block.origName}">
</div>

    </th:block>
  </th:block>

  <!-- âœ… blocks ì—†ìœ¼ë©´ fallback -->
  <th:block th:unless="${blocks != null and !blocks.isEmpty()}">
    <div class="pd-block">
      <div class="pd-text" th:text="${post.content}"></div>
    </div>

    <!-- êµ¬ë²„ì „ ê¸€: imagesê°€ ìˆìœ¼ë©´ ê°™ì´ ë³´ì—¬ì£¼ê¸°(ì›í•˜ë©´) -->
    <th:block th:if="${post.images != null and !post.images.isEmpty()}">
      <div class="pd-block pd-img-wrap" th:each="img : ${post.images}">
        <img class="post-image"
             th:src="@{/uploads/{name}(name=${img.saveName})}"
             th:alt="${img.origName}">
      </div>
    </th:block>
  </th:block>
</div>


        <div class="post-actions">
          <button class="action-button" id="likeButton"
                  th:classappend="${post.isLiked} ? 'liked' : ''"
                  onclick="toggleLike()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
            <span id="likeCount" th:text="${post.likeCount != null ? post.likeCount : 0}">0</span>
          </button>

          <button class="action-button" id="bookmarkButton"
                  th:classappend="${post.isBookmarked != null and post.isBookmarked} ? 'bookmarked' : ''"
                  onclick="toggleBookmark()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
            </svg>
            ë¶ë§ˆí¬
          </button>

          <button class="action-button share-button" onclick="sharePost()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="18" cy="5" r="3"></circle>
              <circle cx="6" cy="12" r="3"></circle>
              <circle cx="18" cy="19" r="3"></circle>
              <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
              <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
            </svg>
            ê³µìœ 
          </button>

          <button class="action-button" onclick="reportPost()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
              <line x1="12" y1="9" x2="12" y2="13"></line>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
            ì‹ ê³ 
          </button>
        </div>
      </div>

      <!-- ì´ì „ê¸€/ë‹¤ìŒê¸€ -->
      <div class="post-navigation">
        <div class="nav-item">
          <span class="nav-label">ì´ì „ê¸€</span>
          <a class="nav-link" th:if="${prevPost != null}"
             th:href="@{/board/postDetail/{id}(id=${prevPost.postId})}"
             th:text="${prevPost.title}">ì´ì „ ê²Œì‹œê¸€ ì œëª©</a>
          <span class="nav-empty" th:if="${prevPost == null}">ì´ì „ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤</span>
        </div>
        <div class="nav-item">
          <span class="nav-label">ë‹¤ìŒê¸€</span>
          <a class="nav-link" th:if="${nextPost != null}"
             th:href="@{/board/postDetail/{id}(id=${nextPost.postId})}"
             th:text="${nextPost.title}">ë‹¤ìŒ ê²Œì‹œê¸€ ì œëª©</a>
          <span class="nav-empty" th:if="${nextPost == null}">ë‹¤ìŒ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤</span>
        </div>
      </div>

      <!-- ëŒ“ê¸€ ì„¹ì…˜ -->
      <div class="comments-section">
        <div class="comments-header">
          <h2 class="comments-title">
            ëŒ“ê¸€ <span class="comments-count" th:text="${post.commentCount}">0</span>
          </h2>
        </div>

        <!-- ë¡œê·¸ì¸ ì•ˆí–ˆì„ ë•Œ -->
        <div th:unless="${isAuthenticated}" class="comment-notice">
          ëŒ“ê¸€ì„ ì‘ì„±í•˜ë ¤ë©´ <a href="/app/login">ë¡œê·¸ì¸</a>ì´ í•„ìš”í•©ë‹ˆë‹¤.
        </div>

        <div class="comments-list">
          <div th:if="${post.comments != null and !post.comments.isEmpty()}">
            <div class="comment-item" th:each="comment : ${post.comments}">
              <div class="comment-author">
                <div class="comment-avatar">
  <img th:if="${comment.authorProfileImage != null and !comment.authorProfileImage.isEmpty()}"
       th:src="@{/uploads/{name}(name=${comment.authorProfileImage})}"
       alt="commenter"
       style="width:100%; height:100%; border-radius:50%; object-fit:cover; display:block;" />
  <span th:unless="${comment.authorProfileImage != null and !comment.authorProfileImage.isEmpty()}"
        th:text="${comment.authorName != null ? comment.authorName.substring(0, 1) : 'U'}">í™</span>
</div>
                <div class="comment-author-info">
                  <div class="comment-author-name" th:text="${comment.authorName}">í™ê¸¸ë™</div>
                  <div class="comment-date"
                       th:text="${dateUtil != null ? dateUtil.formatDateTime(comment.createdAt) : '0000.00.00 00:00'}"></div>
                </div>
              </div>

              <div class="comment-content" th:text="${comment.content}">ëŒ“ê¸€ ë‚´ìš©</div>

              <!-- ë¡œê·¸ì¸ í–ˆì„ ë•Œë§Œ -->
              <div class="comment-actions-row" th:if="${isAuthenticated}">
                <button class="comment-action-btn" onclick="toggleCommentLike(this)">
                  <svg style="width: 14px; height: 14px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                  </svg>
                  ì¢‹ì•„ìš” <span>0</span>
                </button>
                <button class="comment-action-btn" onclick="replyComment()">ë‹µê¸€</button>
              </div>
            </div>
          </div>

          <!-- ëŒ“ê¸€ ì‘ì„± í¼ -->
          <div th:if="${isAuthenticated}" class="comment-form">
            <form th:action="@{/board/postDetail/{postId}/comments(postId=${post.postId})}" method="post">
              <textarea name="content" class="comment-textarea"
                        placeholder="ëŒ“ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”" maxlength="500" required></textarea>
              <div class="comment-form-actions">
                <button type="submit" class="submit-comment-btn">ëŒ“ê¸€ ì‘ì„±</button>
              </div>
            </form>
          </div>

          <!-- ì„±ê³µ/ì—ëŸ¬ ë©”ì‹œì§€ -->
          <div th:if="${successMessage}" class="alert alert-success"
               style="margin: 1rem 2rem; padding: 1rem; background: #d1fae5; color: #065f46; border-radius: 8px;">
            <span th:text="${successMessage}"></span>
          </div>

          <div th:if="${errorMessage}" class="alert alert-error"
               style="margin: 1rem 2rem; padding: 1rem; background: #fee2e2; color: #991b1b; border-radius: 8px;">
            <span th:text="${errorMessage}"></span>
          </div>

          <div th:if="${post.comments == null or post.comments.isEmpty()}" class="empty-comments">
            ì²« ë²ˆì§¸ ëŒ“ê¸€ì„ ì‘ì„±í•´ë³´ì„¸ìš”!
          </div>
        </div>
      </div>
    </main>

    <!-- ìš°ì¸¡ ì‚¬ì´ë“œë°” -->
    <aside class="sidebar-right">
      <!-- ì¸ê¸° ê²Œì‹œê¸€ -->
      <div class="sidebar-section">
        <h4 class="sidebar-title">ğŸ”¥ ì¸ê¸° ê²Œì‹œê¸€</h4>
        <ul class="popular-list">
          <li class="popular-item" th:each="popular, iter : ${popularPosts}">
            <span class="popular-rank"
                  th:classappend="${iter.index < 3} ? 'top3' : ''"
                  th:text="${iter.index + 1}">1</span>
            <div class="popular-content">
              <a th:href="@{/board/postDetail/{id}(id=${popular.postId})}"
                 class="popular-title"
                 th:text="${popular.title}">ê²Œì‹œê¸€ ì œëª©</a>
              <div class="popular-stats">
                <span th:text="'ğŸ‘ ' + ${popular.viewCount}">ğŸ‘ 0</span>
                <span th:text="'â¤ ' + ${popular.likeCount}">â¤ 0</span>
              </div>
            </div>
          </li>

          <li th:if="${popularPosts == null or popularPosts.isEmpty()}"
              style="padding: 2rem; text-align: center; color: #9ca3af;">
            ì¸ê¸° ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤
          </li>
        </ul>
      </div>

      <!-- ì‹¤ì‹œê°„ íƒœê·¸ -->
      <div class="sidebar-section">
        <h4 class="sidebar-title">ğŸ· ì‹¤ì‹œê°„ íƒœê·¸</h4>
        <div class="tags-cloud">
          <a href="#" class="tag-item">#React</a>
          <a href="#" class="tag-item">#SpringBoot</a>
          <a href="#" class="tag-item">#Node.js</a>
          <a href="#" class="tag-item">#Oracle</a>
          <a href="#" class="tag-item">#JavaScript</a>
          <a href="#" class="tag-item">#CSS</a>
        </div>
      </div>

      <!-- ê´‘ê³  ë°°ë„ˆ -->
      <div class="sidebar-section">
        <div class="ad-banner">
          <p class="ad-label">Advertisement</p>
          <h5>ì»¤ë®¤ë‹ˆí‹° í”„ë¦¬ë¯¸ì—„</h5>
          <p>ê´‘ê³  ì—†ì´ ë” ì¾Œì í•˜ê²Œ!</p>
          <button class="ad-btn">ìì„¸íˆ ë³´ê¸°</button>
        </div>
      </div>
    </aside>
  </div>

  <th:block th:include="common/footer"></th:block>

  <script th:inline="javascript">
    /*<![CDATA[*/
    const postId = /*[[${post.postId}]]*/ 1;
    const isAuthenticated = /*[[${isAuthenticated}]]*/ false;
    const memberId = /*[[${memberId}]]*/ null;

    console.log('postId:', postId);
    console.log('isAuthenticated:', isAuthenticated, typeof isAuthenticated);
    console.log('memberId:', memberId);

    // ì¢‹ì•„ìš” í† ê¸€
    function toggleLike() {
      if (!isAuthenticated) {
        Swal.fire({
          title: 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤',
          text: 'ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
          icon: 'warning',
          showCancelButton: true,
          confirmButtonColor: '#2563eb',
          cancelButtonColor: '#6b7280',
          confirmButtonText: 'ë¡œê·¸ì¸',
          cancelButtonText: 'ì·¨ì†Œ'
        }).then((result) => {
          if (result.isConfirmed) {
            window.location.href = '/app/login';
          }
        });
        return;
      }

      const button = document.getElementById('likeButton');
      const countSpan = document.getElementById('likeCount');

      fetch('/board/postDetail/' + postId + '/like', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        credentials: 'include'
      })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          button.classList.toggle('liked');
          countSpan.textContent = data.likeCount;
          
          // ì¢‹ì•„ìš” í† ìŠ¤íŠ¸ ì•Œë¦¼
          const Toast = Swal.mixin({
            toast: true,
            position: 'top',
            showConfirmButton: false,
            timer: 1500,
            timerProgressBar: true
          });
          
          Toast.fire({
            icon: 'success',
            title: button.classList.contains('liked') ? 'ì¢‹ì•„ìš”!' : 'ì¢‹ì•„ìš” ì·¨ì†Œ'
          });
        } else {
          Swal.fire({
            icon: 'error',
            title: 'ì˜¤ë¥˜',
            text: data.message || 'ì¢‹ì•„ìš” ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'
          });
          
          if (data.message && data.message.includes('ë¡œê·¸ì¸')) {
            setTimeout(() => {
              window.location.href = '/app/login';
            }, 1500);
          }
        }
      })
      .catch(err => {
        console.error(err);
        Swal.fire({
          icon: 'error',
          title: 'ì˜¤ë¥˜ ë°œìƒ',
          text: 'ì¢‹ì•„ìš” ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
        });
      });
    }

    // ë¶ë§ˆí¬ í† ê¸€
    function toggleBookmark() {
      if (!isAuthenticated) {
        Swal.fire({
          title: 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤',
          text: 'ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
          icon: 'warning',
          showCancelButton: true,
          confirmButtonColor: '#2563eb',
          cancelButtonColor: '#6b7280',
          confirmButtonText: 'ë¡œê·¸ì¸',
          cancelButtonText: 'ì·¨ì†Œ'
        }).then((result) => {
          if (result.isConfirmed) {
            window.location.href = '/app/login';
          }
        });
        return;
      }

      const button = document.getElementById('bookmarkButton');

      fetch('/board/postDetail/' + postId + '/bookmark', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        credentials: 'include'
      })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          button.classList.toggle('bookmarked');
          
          // ë¶ë§ˆí¬ í† ìŠ¤íŠ¸ ì•Œë¦¼
          const Toast = Swal.mixin({
            toast: true,
            position: 'top',
            showConfirmButton: false,
            timer: 1500,
            timerProgressBar: true
          });
          
          Toast.fire({
            icon: 'success',
            title: data.message
          });
        } else {
          Swal.fire({
            icon: 'error',
            title: 'ì˜¤ë¥˜',
            text: data.message || 'ë¶ë§ˆí¬ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'
          });
          
          if (data.message && data.message.includes('ë¡œê·¸ì¸')) {
            setTimeout(() => {
              window.location.href = '/app/login';
            }, 1500);
          }
        }
      })
      .catch(err => {
        console.error(err);
        Swal.fire({
          icon: 'error',
          title: 'ì˜¤ë¥˜ ë°œìƒ',
          text: 'ë¶ë§ˆí¬ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
        });
      });
    }

    // ê³µìœ 
    function sharePost() {
      if (navigator.share) {
        navigator.share({
          title: /*[[${post.title}]]*/ 'ê²Œì‹œê¸€',
          url: window.location.href
        });
      } else {
        navigator.clipboard.writeText(window.location.href);
        
        const Toast = Swal.mixin({
          toast: true,
          position: 'top',
          showConfirmButton: false,
          timer: 2000,
          timerProgressBar: true
        });
        
        Toast.fire({
          icon: 'success',
          title: 'ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!'
        });
      }
    }

    // ì‹ ê³ 
    function reportPost() {
      if (!isAuthenticated) {
        Swal.fire({
          title: 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤',
          text: 'ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
          icon: 'warning',
          showCancelButton: true,
          confirmButtonColor: '#2563eb',
          cancelButtonColor: '#6b7280',
          confirmButtonText: 'ë¡œê·¸ì¸',
          cancelButtonText: 'ì·¨ì†Œ'
        }).then((result) => {
          if (result.isConfirmed) {
            window.location.href = '/app/login';
          }
        });
        return;
      }

      Swal.fire({
        title: 'ê²Œì‹œê¸€ ì‹ ê³ ',
        text: 'ì´ ê²Œì‹œê¸€ì„ ì‹ ê³ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#dc2626',
        cancelButtonColor: '#6b7280',
        confirmButtonText: 'ì‹ ê³ ',
        cancelButtonText: 'ì·¨ì†Œ'
      }).then((result) => {
        if (result.isConfirmed) {
          fetch('/board/postDetail/' + postId + '/report', {
            method: 'POST',
            credentials: 'include'
          })
          .then(res => res.json())
          .then(data => {
            if (data.success) {
              Swal.fire({
                icon: 'success',
                title: 'ì‹ ê³  ì™„ë£Œ',
                text: 'ì‹ ê³ ê°€ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.',
                confirmButtonColor: '#2563eb'
              });
            } else {
              Swal.fire({
                icon: 'error',
                title: 'ì‹ ê³  ì‹¤íŒ¨',
                text: data.message || 'ì‹ ê³  ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'
              });
            }
          })
          .catch(err => {
            console.error(err);
            Swal.fire({
              icon: 'error',
              title: 'ì˜¤ë¥˜ ë°œìƒ',
              text: 'ì‹ ê³  ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
            });
          });
        }
      });
    }

    // íŒ”ë¡œìš°
    function followAuthor() {
      if (!isAuthenticated) {
        Swal.fire({
          title: 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤',
          text: 'ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
          icon: 'warning',
          showCancelButton: true,
          confirmButtonColor: '#2563eb',
          cancelButtonColor: '#6b7280',
          confirmButtonText: 'ë¡œê·¸ì¸',
          cancelButtonText: 'ì·¨ì†Œ'
        }).then((result) => {
          if (result.isConfirmed) {
            window.location.href = '/app/login';
          }
        });
        return;
      }
      
      const Toast = Swal.mixin({
        toast: true,
        position: 'top',
        showConfirmButton: false,
        timer: 2000,
        timerProgressBar: true
      });
      
      Toast.fire({
        icon: 'success',
        title: 'íŒ”ë¡œìš° ë˜ì—ˆìŠµë‹ˆë‹¤!'
      });
    }

    // ì´ë¯¸ì§€ ëª¨ë‹¬
    function setupImageModal() {
      const images = document.querySelectorAll('.post-image');
      const modal = document.createElement('div');
      modal.className = 'image-modal';
      document.body.appendChild(modal);

      images.forEach(img => {
        img.addEventListener('click', function() {
          const modalImg = document.createElement('img');
          modalImg.src = this.src;
          modalImg.alt = this.alt;

          modal.innerHTML = '';
          modal.appendChild(modalImg);
          modal.classList.add('active');
        });
      });

      modal.addEventListener('click', function() {
        this.classList.remove('active');
      });
    }

    document.addEventListener('DOMContentLoaded', setupImageModal);

    // ê²Œì‹œê¸€ ìˆ˜ì •
    function editPost() {
      window.location.href = '/app/boardEditePage/' + postId;
    }

    // ê²Œì‹œê¸€ ì‚­ì œ
    function deletePost() {
      Swal.fire({
        title: 'ê²Œì‹œê¸€ ì‚­ì œ',
        text: 'ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#dc2626',
        cancelButtonColor: '#6b7280',
        confirmButtonText: 'ì‚­ì œ',
        cancelButtonText: 'ì·¨ì†Œ'
      }).then((result) => {
        if (result.isConfirmed) {
          fetch('/board/delete/' + postId, {
            method: 'POST',
            credentials: 'include'
          })
          .then(res => res.json())
          .then(data => {
            if (data.success) {
              Swal.fire({
                icon: 'success',
                title: 'ì‚­ì œ ì™„ë£Œ',
                text: 'ê²Œì‹œê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.',
                confirmButtonColor: '#2563eb'
              }).then(() => {
                window.location.href = '/board';
              });
            } else {
              Swal.fire({
                icon: 'error',
                title: 'ì‚­ì œ ì‹¤íŒ¨',
                text: data.message || 'ê²Œì‹œê¸€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'
              });
            }
          })
          .catch(err => {
            console.error(err);
            Swal.fire({
              icon: 'error',
              title: 'ì˜¤ë¥˜ ë°œìƒ',
              text: 'ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
            });
          });
        }
      });
    }

    // ëŒ“ê¸€ ì¢‹ì•„ìš”(ì„ì‹œ)
    function toggleCommentLike(button) {
      if (!isAuthenticated) {
        Swal.fire({
          title: 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤',
          text: 'ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
          icon: 'warning',
          showCancelButton: true,
          confirmButtonColor: '#2563eb',
          cancelButtonColor: '#6b7280',
          confirmButtonText: 'ë¡œê·¸ì¸',
          cancelButtonText: 'ì·¨ì†Œ'
        }).then((result) => {
          if (result.isConfirmed) {
            window.location.href = '/app/login';
          }
        });
        return;
      }
      
      button.classList.toggle('liked');
      const countSpan = button.querySelector('span');
      const currentCount = parseInt(countSpan.textContent, 10);
      countSpan.textContent = button.classList.contains('liked') ? currentCount + 1 : currentCount - 1;
    }

    // ë‹µê¸€(ì„ì‹œ)
    function replyComment() {
      const Toast = Swal.mixin({
        toast: true,
        position: 'top',
        showConfirmButton: false,
        timer: 2000,
        timerProgressBar: true
      });
      
      Toast.fire({
        icon: 'info',
        title: 'ë‹µê¸€ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤!'
      });
    }
 // íŒ”ë¡œìš°
    function followAuthor() {
      if (!isAuthenticated) {
        Swal.fire({
          title: 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤',
          text: 'ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
          icon: 'warning',
          showCancelButton: true,
          confirmButtonColor: '#2563eb',
          cancelButtonColor: '#6b7280',
          confirmButtonText: 'ë¡œê·¸ì¸',
          cancelButtonText: 'ì·¨ì†Œ'
        }).then((result) => {
          if (result.isConfirmed) {
            window.location.href = '/app/login';
          }
        });
        return;
      }
      
      const authorId = [[${post.authorId}]];
      const button = document.getElementById('followButton');
      const followerCount = document.getElementById('followerCount');
      
      fetch('/board/author/' + authorId + '/follow', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        credentials: 'include'
      })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
          if (data.isFollowing) {
            button.classList.add('following');
            button.querySelector('span').textContent = 'íŒ”ë¡œì‰';
            followerCount.textContent = parseInt(followerCount.textContent) + 1;
          } else {
            button.classList.remove('following');
            button.querySelector('span').textContent = 'íŒ”ë¡œìš°';
            followerCount.textContent = parseInt(followerCount.textContent) - 1;
          }
          
          // í† ìŠ¤íŠ¸ ì•Œë¦¼
          const Toast = Swal.mixin({
            toast: true,
            position: 'top',
            showConfirmButton: false,
            timer: 1500,
            timerProgressBar: true
          });
          
          Toast.fire({
            icon: 'success',
            title: data.message
          });
        } else {
          Swal.fire({
            icon: 'error',
            title: 'ì˜¤ë¥˜',
            text: data.message
          });
        }
      })
      .catch(err => {
        console.error(err);
        Swal.fire({
          icon: 'error',
          title: 'ì˜¤ë¥˜ ë°œìƒ',
          text: 'íŒ”ë¡œìš° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
        });
      });
    }
    /*]]>*/
</script>
</body>
</html>
