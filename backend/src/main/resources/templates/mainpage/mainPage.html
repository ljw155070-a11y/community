<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>커뮤니티 메인</title>
    <link rel="stylesheet" href="/communityCss/mainPage.css" />
  </head>
  <body>
    <th:block th:include="common/header"></th:block>
    <!-- 메인 배너 영역 -->
    <section class="mainpage-banner">
      <div class="mainpage-banner-content">
        <h1>함께 소통하고 성장하는 커뮤니티</h1>
        <p>다양한 주제로 대화하고, 지식을 공유하며, 새로운 친구를 만나보세요</p>
        <!-- 로그인/회원가입 버튼 -->
        <div class="mainpage-banner-buttons">
          <!-- 로그인 페이지로 이동 -->
          <button class="mainpage-btn-primary" onclick="location.href='/login'">
            로그인
          </button>
          <!-- 회원가입 페이지로 이동 -->
          <button
            class="mainpage-btn-secondary"
            onclick="location.href='/signup'"
          >
            처음이신가요?
          </button>
        </div>
      </div>
    </section>

    <!-- 커뮤니티 특징 소개 -->
    <section class="mainpage-features">
      <h2>커뮤니티의 특징</h2>
      <div class="mainpage-feature-list">
        <!-- 특징 1 -->
        <div class="mainpage-feature-item">
          <div class="mainpage-feature-icon">💬</div>
          <h3>자유로운 소통</h3>
          <p>다양한 주제로 자유롭게 대화하고 의견을 나눠보세요</p>
        </div>
        <!-- 특징 2 -->
        <div class="mainpage-feature-item">
          <div class="mainpage-feature-icon">👥</div>
          <h3>활발한 커뮤니티</h3>
          <p>활발하게 질문과 답변 등을 올리는 커뮤니티</p>
        </div>
        <!-- 특징 3 -->
        <div class="mainpage-feature-item">
          <div class="mainpage-feature-icon">📈</div>
          <h3>트렌딩 콘텐츠</h3>
          <p>인기 있는 게시글과 핫한 토픽을 만들어요</p>
        </div>
      </div>
    </section>

    <!-- 인기 게시글 영역 -->
    <section class="mainpage-posts">
      <div class="mainpage-posts-header">
        <h2>인기 게시글</h2>
        <a href="javascript:void(0);" class="mainpage-more-link" onclick="togglePosts()">더보기 ↓</a>
      </div>
      <!-- 게시글 목록 -->
      <div class="mainpage-post-list" id="postList">
        <!-- 타임리프로 반복 -->
        <div class="mainpage-post-card" 
		     th:each="post, stat : ${postList}" 
		     th:classappend="${stat.index >= 3} ? 'mainpage-post-hidden' : ''">
		  <!-- 조회수/좋아요/댓글 TOP 표시 -->
		  <span class="mainpage-top-badge view-badge" th:if="${stat.index < 4}">👁 조회수 TOP</span>
		  <span class="mainpage-top-badge like-badge" th:if="${stat.index >= 4 && stat.index < 8}">❤ 좋아요 TOP</span>
		  <span class="mainpage-top-badge comment-badge" th:if="${stat.index >= 8}">💬 댓글 TOP</span>
		  
		  <span class="mainpage-post-tag" th:text="${post.categoryName}">자유</span>
		  <h3 th:text="${post.title}">제목</h3>
		  <div class="mainpage-post-info">
		    <span th:text="${post.nickname}">작성자</span>
		    <span th:text="'👁 ' + ${post.viewCount}">조회수</span>
		    <span th:text="'❤ ' + ${post.likeCount}">좋아요</span>
		    <span th:text="'💬 ' + ${post.commentCount}">댓글</span>
		  </div>
		</div>
      </div>
    </section>

    <!-- 공지사항 영역 -->
    <section class="mainpage-notices">
      <div class="mainpage-notices-header">
        <h2>공지사항</h2>
        <a href="javascript:void(0);" class="mainpage-more-link" onclick="toggleNotices()">더보기 ↓</a>
      </div>
      <!-- 공지사항 목록 -->
      <div class="mainpage-notice-list" id="noticeList">
        <!-- 타임리프로 반복 -->
        <div class="mainpage-notice-item" 
             th:each="notice, stat : ${noticeList}"
             th:classappend="${stat.index >= 3} ? 'mainpage-notice-hidden' : ''">
          <span class="mainpage-notice-badge" th:text="${notice.noticeType}">공지</span>
          <span class="mainpage-notice-title" th:text="${notice.title}">제목</span>
          <span class="mainpage-notice-date" 
                th:text="${#dates.format(notice.createdAt, 'yyyy. MM. dd.')}">날짜</span>
        </div>
      </div>
    </section>

    <!-- 하단 배너 -->
    <section class="mainpage-bottom-banner">
      <div class="mainpage-bottom-content">
        <h2>지금 바로 커뮤니티에 참여하세요</h2>
        <p>무료로 가입하고 다양한 사람들과 소통해보세요</p>
        <!-- 회원가입 페이지로 이동 -->
        <button class="mainpage-btn-join" onclick="location.href='/signup'">
          회원가입
        </button>
      </div>
    </section>
<th:block th:include="common/footer"></th:block>
    <!-- 자바스크립트 -->
    <script>
      // 게시글 더보기 토글 (3개 <-> 12개)
      function togglePosts() {
        const hiddenPosts = document.querySelectorAll(".mainpage-post-hidden");
        const moreLink = document.querySelector(
          ".mainpage-posts .mainpage-more-link"
        );

        // 숨겨진 게시글이 있으면 모두 보여주기
        if (
          hiddenPosts[0].style.display === "none" ||
          hiddenPosts[0].style.display === ""
        ) {
          hiddenPosts.forEach((post) => {
            post.style.display = "block";
          });
          moreLink.textContent = "접기 ↑";
        } else {
          // 숨기기
          hiddenPosts.forEach((post) => {
            post.style.display = "none";
          });
          moreLink.textContent = "더보기 ↓";
        }
      }

      // 공지사항 더보기 토글 (3개 <-> 10개)
      function toggleNotices() {
        const hiddenNotices = document.querySelectorAll(
          ".mainpage-notice-hidden"
        );
        const moreLink = document.querySelector(
          ".mainpage-notices .mainpage-more-link"
        );

        // 숨겨진 공지사항이 있으면 모두 보여주기
        if (
          hiddenNotices[0].style.display === "none" ||
          hiddenNotices[0].style.display === ""
        ) {
          hiddenNotices.forEach((notice) => {
            notice.style.display = "flex";
          });
          moreLink.textContent = "접기 ↑";
        } else {
          // 숨기기
          hiddenNotices.forEach((notice) => {
            notice.style.display = "none";
          });
          moreLink.textContent = "더보기 ↓";
        }
      }

      // 페이지 로드시 숨김 처리
      window.onload = function () {
        const hiddenPosts = document.querySelectorAll(".mainpage-post-hidden");
        hiddenPosts.forEach((post) => {
          post.style.display = "none";
        });

        const hiddenNotices = document.querySelectorAll(
          ".mainpage-notice-hidden"
        );
        hiddenNotices.forEach((notice) => {
          notice.style.display = "none";
        });
      };
    </script>
  </body>
</html>